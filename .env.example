# ============================================================================
# Keyword Research Tool - Environment Configuration
# ============================================================================
# Copy this file to .env and fill in your API keys
# NEVER commit .env to version control
# See SECURITY.md for best practices
# ============================================================================

# ----------------------------------------------------------------------------
# REQUIRED: SERP Data Provider (choose one)
# ----------------------------------------------------------------------------
# Get free key at: https://serpapi.com/users/sign_up (100 searches/month free)
SERPAPI_API_KEY=your_serpapi_key_here

# Alternative providers (optional)
ZENSERP_API_KEY=
DATAFORSEO_LOGIN=
DATAFORSEO_PASSWORD=
SERP_PROVIDER=serpapi  # Options: serpapi, zenserp, dataforseo

# ----------------------------------------------------------------------------
# OPTIONAL: Google Ads API (for official search volume and CPC data)
# ----------------------------------------------------------------------------
# Setup guide: https://developers.google.com/google-ads/api/docs/first-call/overview
GOOGLE_ADS_CLIENT_ID=your_client_id.apps.googleusercontent.com
GOOGLE_ADS_CLIENT_SECRET=your_client_secret
GOOGLE_ADS_DEVELOPER_TOKEN=your_developer_token
GOOGLE_ADS_REFRESH_TOKEN=your_refresh_token
GOOGLE_ADS_CUSTOMER_ID=123-456-7890
GOOGLE_ADS_LOGIN_CUSTOMER_ID=123-456-7890

# ----------------------------------------------------------------------------
# OPTIONAL: Google APIs (for Trends and Search Console)
# ----------------------------------------------------------------------------
# OAuth2 credentials for Google Sheets export and Search Console
GOOGLE_OAUTH_CLIENT_ID=your_client_id.apps.googleusercontent.com
GOOGLE_OAUTH_CLIENT_SECRET=your_client_secret
GOOGLE_OAUTH_REFRESH_TOKEN=your_refresh_token

# Google Search Console property
SEARCH_CONSOLE_PROPERTY_URL=https://www.example.com/

# ----------------------------------------------------------------------------
# OPTIONAL: Export Integrations
# ----------------------------------------------------------------------------
# Notion API (for exporting briefs to Notion)
# Get key at: https://www.notion.so/my-integrations
NOTION_API_KEY=secret_your_notion_api_key
NOTION_DATABASE_ID=your_database_id_32chars

# Google Sheets API
# Path to service account JSON file
GOOGLE_SHEETS_CREDENTIALS_PATH=./credentials/google_sheets_service_account.json
GOOGLE_SHEETS_FOLDER_ID=your_google_drive_folder_id

# WordPress REST API
# Use Application Password (WordPress 5.6+)
# Create at: WP Admin → Users → Your Profile → Application Passwords
WORDPRESS_URL=https://yoursite.com
WORDPRESS_USERNAME=admin
WORDPRESS_APP_PASSWORD=xxxx xxxx xxxx xxxx xxxx xxxx

# ----------------------------------------------------------------------------
# Database Configuration
# ----------------------------------------------------------------------------
# SQLite (default - for development and small projects)
DATABASE_URL=sqlite:///./keyword_research.db

# PostgreSQL (recommended for production)
# DATABASE_URL=postgresql://user:password@localhost:5432/keyword_research

# MySQL (alternative)
# DATABASE_URL=mysql+pymysql://user:password@localhost:3306/keyword_research

# ----------------------------------------------------------------------------
# Cache & Queue (optional - for production)
# ----------------------------------------------------------------------------
# Redis (for caching and task queue)
REDIS_URL=redis://localhost:6379/0
CELERY_BROKER_URL=redis://localhost:6379/1
CELERY_RESULT_BACKEND=redis://localhost:6379/2

# Cache TTL (seconds)
SERP_CACHE_TTL=604800  # 7 days
TRENDS_CACHE_TTL=86400  # 1 day
AUTOSUGGEST_CACHE_TTL=86400  # 1 day

# ----------------------------------------------------------------------------
# Rate Limiting (requests per minute)
# ----------------------------------------------------------------------------
# Adjust based on your API plan and quota
GOOGLE_ADS_RPM=60
SERP_API_RPM=20  # Free tier: ~20 RPM safe, adjust for paid plans
AUTOSUGGEST_RPM=10  # Conservative for autosuggest scraping
TRENDS_RPM=60
SEARCH_CONSOLE_RPM=30

# Global rate limiting (across all providers)
GLOBAL_RPM=100
ENABLE_RATE_LIMITING=true

# ----------------------------------------------------------------------------
# Clustering & Scoring Configuration
# ----------------------------------------------------------------------------
# Topic clustering (broader themes, lower = more clusters)
TOPIC_CLUSTER_THRESHOLD=0.78

# Page grouping (tighter clustering, higher = fewer pages)
PAGE_GROUP_THRESHOLD=0.88

# Internal link similarity
SIBLING_LINK_THRESHOLD=0.90

# Minimum keywords per cluster (auto-merge small clusters)
MIN_CLUSTER_SIZE=3

# Scoring weights config (path to YAML file)
SCORING_WEIGHTS_CONFIG=./config/scoring_weights.yaml
CTR_MODEL_CONFIG=./config/ctr_model.yaml

# ----------------------------------------------------------------------------
# Processing Settings
# ----------------------------------------------------------------------------
# Deduplication similarity threshold (0-1, higher = more strict)
DEDUP_SIMILARITY_THRESHOLD=0.90

# Minimum search volume to include (0 = include all)
MIN_SEARCH_VOLUME=0

# Maximum difficulty to include (0-100, 100 = include all)
MAX_DIFFICULTY=100

# Keyword expansion limits
MAX_KEYWORDS_PER_SEED=100
MAX_TOTAL_KEYWORDS=1000

# ----------------------------------------------------------------------------
# Default Settings
# ----------------------------------------------------------------------------
DEFAULT_LANGUAGE=en
DEFAULT_GEO=US
DEFAULT_TARGET_RANK=3  # For CTR calculations
DEFAULT_CONTENT_FOCUS=informational  # Options: informational, commercial, transactional, local, navigational

# ----------------------------------------------------------------------------
# Telemetry & Privacy
# ----------------------------------------------------------------------------
# Anonymous usage analytics (helps improve the tool)
ENABLE_TELEMETRY=false
TELEMETRY_ENDPOINT=none

# Audit logging (logs all API calls for debugging and quota tracking)
ENABLE_AUDIT_LOG=true
AUDIT_LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR

# Data snapshot (save raw API responses for reproducibility)
ENABLE_DATA_SNAPSHOT=true
DATA_SNAPSHOT_PATH=./data/raw

# ----------------------------------------------------------------------------
# Feature Flags
# ----------------------------------------------------------------------------
# Enable/disable specific expansion methods
ENABLE_AUTOSUGGEST=true
ENABLE_PAA=true
ENABLE_RELATED_SEARCHES=true
ENABLE_TRENDS=true
ENABLE_COMPETITOR_GAP=false  # Experimental
ENABLE_YOUTUBE_SUGGESTIONS=false  # Experimental
ENABLE_REDDIT_KEYWORDS=false  # Experimental

# Enable/disable export formats
ENABLE_CSV_EXPORT=true
ENABLE_SHEETS_EXPORT=true
ENABLE_NOTION_EXPORT=true
ENABLE_WORDPRESS_EXPORT=true

# ----------------------------------------------------------------------------
# Advanced Settings
# ----------------------------------------------------------------------------
# Parallel processing (number of workers)
MAX_WORKERS=4

# Batch size for API calls
API_BATCH_SIZE=10

# Retry configuration
MAX_RETRIES=3
RETRY_BACKOFF_FACTOR=2  # Exponential backoff: 2, 4, 8 seconds

# Request timeout (seconds)
REQUEST_TIMEOUT=30

# Model settings
EMBEDDING_MODEL=sentence-transformers/all-MiniLM-L6-v2
CLUSTERING_ALGORITHM=agglomerative  # Options: agglomerative, dbscan, kmeans

# NLP settings
SPACY_MODEL=en_core_web_sm
LEMMATIZATION_ENABLED=true
STOPWORD_REMOVAL=true

# ----------------------------------------------------------------------------
# Development & Debugging
# ----------------------------------------------------------------------------
# Debug mode (more verbose logging)
DEBUG=false
LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR, CRITICAL

# Offline mode (use only cached data, no API calls)
OFFLINE_MODE=false

# Dry run mode (simulate without making changes)
DRY_RUN=false

# Pretty print JSON responses
PRETTY_JSON=true

# ----------------------------------------------------------------------------
# Security Settings
# ----------------------------------------------------------------------------
# Secrets encryption (optional - for production)
ENCRYPT_SECRETS=false
ENCRYPTION_KEY=

# API key rotation reminder (days)
KEY_ROTATION_REMINDER_DAYS=90

# Allow insecure connections (DO NOT USE IN PRODUCTION)
ALLOW_INSECURE=false

# ----------------------------------------------------------------------------
# Data Source Ledger
# ----------------------------------------------------------------------------
# Track which providers contributed to each project
# This information is stored in audit_logs table and can be queried:
# SELECT provider, COUNT(*) as calls FROM audit_logs WHERE project_id=1 GROUP BY provider
DATA_SOURCE_ATTRIBUTION=true

# Providers used (auto-detected based on enabled features):
# - SerpAPI: SERP data, PAA questions, related searches
# - Google Trends: Seasonality, trend direction
# - Autosuggest: Google, Bing, YouTube keyword suggestions
# - Google Ads: Official search volume and CPC (if configured)
# - Search Console: Existing ranking data (if configured)

# ============================================================================
# NOTES:
# - All API keys should be kept secret
# - Use strong, unique keys for production
# - Rotate keys quarterly (see SECURITY.md)
# - Monitor quota usage in audit logs
# - See full documentation in README.md
# ============================================================================
