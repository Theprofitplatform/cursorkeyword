{% extends "base.html" %}

{% block title %}Create Project - Keyword Research Tool{% endblock %}

{% block content %}
<div class="card">
    <h2>Create New Research Project</h2>
    <form id="createForm" onsubmit="createProject(event)">
        <label for="name">Project Name *</label>
        <input type="text" id="name" name="name" placeholder="e.g., Q1 2025 Blog Strategy" required>
        
        <label for="seeds">Seed Keywords * (comma or newline separated)</label>
        <textarea id="seeds" name="seeds" rows="4" placeholder="e.g., content marketing, seo tools, keyword research" required></textarea>
        
        <label for="geo">Country/Region</label>
        <select id="geo" name="geo">
            <option value="US">🇺🇸 United States</option>
            <option value="UK">🇬🇧 United Kingdom</option>
            <option value="CA">🇨🇦 Canada</option>
            <option value="AU">🇦🇺 Australia</option>
            <option value="IN">🇮🇳 India</option>
        </select>
        
        <label for="language">Language</label>
        <select id="language" name="language">
            <option value="en">English</option>
            <option value="es">Spanish</option>
            <option value="fr">French</option>
            <option value="de">German</option>
        </select>
        
        <label for="focus">Content Focus</label>
        <select id="focus" name="focus">
            <option value="any">Any Intent</option>
            <option value="informational">Informational (How-to, Guides)</option>
            <option value="commercial">Commercial (Reviews, Best X)</option>
            <option value="transactional">Transactional (Buy, Pricing)</option>
            <option value="navigational">Navigational (Brand searches)</option>
            <option value="local">Local (Near me, Local services)</option>
        </select>
        
        <div id="status" style="margin-top: 20px;"></div>
        
        <button type="submit" class="btn">🚀 Create Project</button>
    </form>
</div>

<div class="card">
    <h2>Expected Results</h2>
    <table>
        <tr>
            <th>Project Size</th>
            <th>Keywords</th>
            <th>Briefs</th>
            <th>Duration</th>
        </tr>
        <tr>
            <td><span class="badge badge-success">Small</span> (1-2 seeds)</td>
            <td>50-100</td>
            <td>20-40</td>
            <td>4-8 min</td>
        </tr>
        <tr>
            <td><span class="badge badge-warning">Medium</span> (3-4 seeds)</td>
            <td>100-200</td>
            <td>40-80</td>
            <td>8-15 min</td>
        </tr>
        <tr>
            <td><span class="badge badge-danger">Large</span> (5+ seeds)</td>
            <td>200-400</td>
            <td>80-150</td>
            <td>15-25 min</td>
        </tr>
    </table>
</div>

<script>
function createProject(event) {
    event.preventDefault();
    
    const statusDiv = document.getElementById('status');
    const submitBtn = event.target.querySelector('button[type="submit"]');
    
    submitBtn.disabled = true;
    submitBtn.textContent = '⏳ Creating...';
    
    const formData = {
        name: document.getElementById('name').value,
        seeds: document.getElementById('seeds').value,
        geo: document.getElementById('geo').value,
        language: document.getElementById('language').value,
        focus: document.getElementById('focus').value
    };
    
    fetch('/api/create', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(formData)
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            statusDiv.innerHTML = `<div class="alert alert-success">
                ✅ ${data.message}<br>
                <strong>Project ID:</strong> ${data.project_id}<br>
                <small>Processing in background... This may take 5-15 minutes.</small><br>
                <a href="/projects" class="btn btn-secondary" style="margin-top: 10px;">View All Projects</a>
                <a href="/project/${data.project_id}" class="btn" style="margin-top: 10px; margin-left: 10px;">View This Project</a>
            </div>`;
            event.target.reset();
        } else {
            statusDiv.innerHTML = `<div class="alert alert-error">❌ ${data.error}</div>`;
        }
    })
    .catch(error => {
        statusDiv.innerHTML = `<div class="alert alert-error">❌ Error: ${error.message}</div>`;
    })
    .finally(() => {
        submitBtn.disabled = false;
        submitBtn.textContent = '🚀 Create Project';
    });
}
</script>
{% endblock %}
